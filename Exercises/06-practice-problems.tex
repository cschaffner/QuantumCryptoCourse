\documentclass[a4paper,10pt,landscape,twocolumn]{scrartcl}

\newcommand{\ket}[1]{| #1 \rangle}
\newcommand{\bra}[1]{\langle #1 |}
\newcommand{\proj}[1]{| #1 \rangle \langle #1 |}
\newcommand{\Tr}{\text{Tr}}

%% Settings
\newcommand\problemset{ 6}
\newcommand\deadline{Friday November 18th, 20:00h}
\newif\ifcomments
\commentsfalse % hide comments
%\commentstrue % show comments

% Packages
\usepackage[english]{exercises}
%\usepackage{wasysym}
%\usepackage{hyperref}
%\hypersetup{colorlinks=true, urlcolor = blue, linkcolor = blue}
\usepackage{bbm}
\usepackage{mathabx}


\begin{document}

\practiceproblems

{\sffamily\noindent
%This week's exercises deal with sets, counting and uniform probabilities.
You do not have to hand in these exercises, they are for practicing only. %Problems marked with a $\bigstar$ are generally a bit harder.
}

\begin{exercise}[Six-state BB'84]
Consider the BB'84 protocol using 6 states instead of 4. To the initial four states $\ket{0}, \ket{1}, \ket{+}, \ket{-}$ we add $\ket{\circlearrowright}$ and $\ket{\circlearrowleft}$ (comprising the third basis). The protocol is executed similarly to the original one, but now Alice sends one of six states and Bob measures in one of the three bases.
\begin{subex}
How many bits are left after Alice and Bob reveal the bases they have chosen.
\end{subex}

\begin{subex}[Intercept and resend attack]
Analyse an intercept-and-resend type of attack where Eve measures Alice's bits in randomly (uniformly and independently) chosen basis and then sends the outcome back to Bob. What is the error rate this attack induces?
\end{subex}

\begin{subex}[Intercept and resend attack in the standard BB'84]
What would be the error rate of the above attack in the original BB'84 protocol?
\end{subex}
\end{exercise}

\begin{exercise}[Entangling attack (Exercise 6.2.1)]
Consider the case of a single EPR pair ($n = 1$), and suppose that Eve applies a
CNOT on her qubit $\ket{0}_E$, controlled on the qubit $B$ that Alice sends to Bob (Eve then forwards
the qubit over to Bob). Compute the resulting joint state $\rho_{ABE}$ . Compute the probability that
Alice and Bob choose the same basis $\theta=\tilde{\theta}$ and obtain $x=\tilde{x}$. What is the approximate error rate they get? Is this a good attack?
\end{exercise}


\begin{exercise}[The matching outcomes test]
\begin{subex}[Exercise 6.2.2]
Suppose given a tripartite state $\rho_{ABE}$, where $A$ and $B$ are each systems of a
single qubit. Show that the probability that a measurement of systems $A$ and $B$ in the standard
basis results in matching outcomes is exactly $\Tr\left( \Pi_1 \rho_{AB}\right)$, where
\begin{equation}
\Pi_1=\proj{\Phi^+}+\proj{\Phi^-}, \text{ and } \ket{\Phi^-}:=\frac{1}{\sqrt{2}}(\ket{00}-\ket{11}).
\end{equation}
Similarly, show that if the measurement is performed in the Hadamard basis then the probability
of obtaining matching outcomes is $\Tr\left( \Pi_2 \rho_{AB}\right)$, with
\begin{equation}
\Pi_2=\proj{\Phi^+}+\proj{\Psi^+}, \text{ and } \ket{\Psi^+}:=\frac{1}{\sqrt{2}}(\ket{01}+\ket{10}).
\end{equation}
\end{subex}

\begin{subex}[Probability of getting matching outcomes]
What is the probability of getting matching outcomes given that Alice and Bob choose the same bases $p$ if Alice and Bob share the state $\rho_{AB}$.
\end{subex}

\begin{subex}[Equation (6.6)]
Prove the inequality 
\begin{equation}
\bra{\Phi^+}\rho_{AB}\ket{\Phi^+}\geq 2p-1,
\end{equation}
where $p$ is the probability of the matching outcomes test succeeding.
\end{subex}

\begin{subex}[Examples]
What is $p$ for the GHZ state ($\ket{\text{GHZ}}=\frac{1}{\sqrt{2}}(\ket{000}+\ket{111})$) and for the W state ($\ket{\text{W}}=\frac{1}{\sqrt{3}}(\ket{100}+\ket{010}+\ket{001})$), what are the bounds for the overlap with the Bell $\ket{\Phi^+}$ state.
\end{subex}

\begin{subex}[Problem 3 from Quiz 6.5]
Let Alice and Bob share $n$ qubit pairs in the state $\rho _{AB}^{\otimes n}$, and suppose the matching outcomes test succeeds with probability exactly $p=0.95$ on each of the $n$ pairs. What is the largest value of $n$ for which the overlap $\langle \Phi^+|^{\otimes n}\rho _{AB}^{\otimes n}|\Phi^+\rangle ^{\otimes n}$ is guaranteed to exceed $1/2$? 
\end{subex}
\end{exercise}


\begin{exercise}[Min-entropy from the matching outcomes bound]
Alice and Bob can extract at most $H_{\text{min}}(X|E)$ bits of randomness to create their key, $X$ is the outcome of Alice's measurement on her qubit. Now we want to connect the conditional min-entropy to the probability that the matching-outcomes test succeeds. We assume that the adversary Eve prepares $n$ identical and uncorrelated copies of the tripartite state $|\psi _{ABE}\rangle$ and sends the qubits $A$ to Alice and $B$ to Bob.
Recall that if Alice measures her qubit in the standard basis, and the resulting post-measurement state on her qubit and Eve's system $E$ is a classical-quantum (cq) state
\begin{equation}
\rho _{XE} = \frac{1}{2}|0\rangle \langle 0| \otimes \rho _ E^{Z,0}+\frac{1}{2}|1\rangle \langle 1| \otimes \rho _ E^{Z,1},
\end{equation}
then the optimal guessing probability $P_{\text{guess}}(X|E)$ such that
\begin{equation}
H_{\min}(X|E) = - \log P_{\text{guess}}(X|E)
\end{equation}
is given by the Helstr\"om measurement, for which
\begin{equation}
P_{\text{guess}}(X|E) = \frac{1}{2}+\frac{1}{4}\| \rho _ E^{Z,0}-\rho _ E^{Z,1}\| _1.
\end{equation}
The same reasoning holds for any other choice of Alice's basis, notably the Hadamard basis $\{ |+\rangle ,|-\rangle \}$. In the BB'84 protocol Alice chooses with probability $1/2$ one of the two bases in which to measure her qubit. If we denote by $P_{\text{guess}}(X|E,\Theta =0)$ and $P_{\text{guess}}(X|E,\Theta =1)$ the optimal guessing probabilities for Alice measuring in the standard ($\Theta =0$) and Hadamard ($\Theta =1$) bases respectively, the desired lower bound is given by
\begin{equation}
H_{\min}(X|E ) = -\log \left[\frac{1}{2}P_{\text{guess}}(X|E,\Theta =0)+\frac{1}{2}P_{\text{guess}}(X|E,\Theta =1)\right].
\end{equation}



\begin{subex}[Problem 1]
Suppose Alice and Bob share a pure Bell pair $|\Phi ^+\rangle$, uncorrelated with Eve's system: $\rho _{ABE} = |\Phi ^+\rangle \langle \Phi ^+|_{AB} \otimes \rho _ E$. What is $H_{\min}(X|E)$? 
\end{subex}
\begin{subex}[Problem 2]
 Now consider the general case, where $|\psi _{ABE}\rangle$ is an arbitrary state prepared by Eve. Let $p$ be the probability that this state succeeds in the matching outcomes test, when Alice and Bob both measure in the same basis $\Theta$ chosen at random. Give coefficients $a,b,c$ such that
\begin{equation}
p = a \langle \psi _{ABE}| X_ A \otimes X_ B \otimes \mathbbm{1}_ E |\psi _{ABE}\rangle + b\langle \psi _{ABE}| Z_ A \otimes Z_ B \otimes \mathbbm{1}_ E |\psi _{ABE}\rangle + c,
\end{equation}
where $X$,$Z$ are the Pauli observables $X = |+\rangle \langle +| - |-\rangle \langle -|$ and $Z = |0\rangle \langle 0| - |1\rangle \langle 1|$. 
\end{subex}
\begin{subex}[Problem 3]
 Let $p_ X$ (resp. $p_ Z$) be the probability that the state $|\psi _{ABE}\rangle$ passes the matching outcomes test in the Hadamard (resp. computational) basis, so that $p=\frac{1}{2}(p_ X+p_ Z)$.

By expanding the qubit $A$ in the computational basis, the state $|\psi _{ABE}\rangle$ can be expressed as $|\psi _{ABE}\rangle = |0\rangle _ A\otimes |u_0)_{BE} + |1\rangle _ A\otimes |u_1) _{BE}$ ($|u)_{BE}$ signifies a not normalized vector in $\mathcal{H}_{BE}$), with $\| |u_0) _{BE}\|^2+\| |u_1)_{BE}\|^2=1$. Give coefficients $a'$,$b'$ such that
\begin{equation}
\langle \psi _{ABE}| X_ A \otimes X_ B \otimes \mathbbm{1}_ E |\psi _{ABE}\rangle = a'\, \mathfrak{Re} (( u_0| X_ B \otimes \mathbbm{1}_ E |u_1) ) + b'.
\end{equation}

\end{subex}

\begin{subex}[Problem 4]
 Suppose Alice measures her qubit in the computational basis: the post-measurement state on $A$ and $E$ (tracing out $B$) can be written as $\rho _{AE}^ Z = |0\rangle \langle 0|_ A\otimes \sigma _ E^{Z,0} + |1\rangle \langle 1|_ A\otimes \sigma _ E^{Z,1}$. Similarly, if Alice measures in the Hadamard basis we may write the post-measurement state as $\rho _{AE}^ X = |+\rangle \langle +|_ A\otimes \sigma _ E^{X,+} + |-\rangle \langle -|_ A\otimes \sigma _ E^{X,-}$.

Use the previous two questions to determine coefficients $\alpha$ ,$\beta$ such that
\begin{equation}
2p-1 \leq \alpha F(\sigma _ E^{X,+},\sigma _ E^{X,-}) + \beta F(\sigma _ E^{Z,0},\sigma _ E^{Z,1}).
\end{equation}


where $F$ denotes the fidelity.

[Hint: observe that $|u_0\rangle _{BE}$ and $|u_1\rangle _{BE}$ considered in the previous question are purifications of $\sigma _ E^{Z,0}$ and $\sigma _ E^{Z,1}$ respectively, and use Uhlmann's theorem] 
\end{subex}

\begin{subex}[Problem 5]
Recall the inequality $D(\rho ,\sigma ) \leq \sqrt {1-F(\rho ,\sigma )^2}$. Using also the definition of $H_{\min} (X|E)$, what is the best lower bound on $H_{\min}(X|E)$ as a function of $p$ that you can get?
\end{subex}


\end{exercise}




\end{document}